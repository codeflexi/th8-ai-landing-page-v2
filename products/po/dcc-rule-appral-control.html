<!doctype html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TH8.AI – Procurement Policy v3 (Business Rule Explanation)</title>

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font -->
    <link
      href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <style>
      html, body { font-family: "Prompt", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
      html { scroll-behavior: smooth; }

      .card { @apply bg-white border border-slate-200 rounded-2xl shadow-sm; }
      .card-h { @apply px-6 pt-5 pb-4 border-b border-slate-100; }
      .card-b { @apply p-6; }

      .label { @apply text-xs uppercase tracking-wide text-slate-500; }
      .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }

      .pill { @apply inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold border; }
      .pill-slate { @apply bg-slate-50 text-slate-700 border-slate-200; }
      .pill-amber { @apply bg-amber-50 text-amber-800 border-amber-200; }
      .pill-rose { @apply bg-rose-50 text-rose-800 border-rose-200; }
      .pill-emerald { @apply bg-emerald-50 text-emerald-800 border-emerald-200; }

      .btn { @apply inline-flex items-center justify-center gap-2 rounded-xl px-4 py-2 text-sm font-medium border; }
      .btn-primary { @apply bg-slate-900 text-white border-slate-900 hover:bg-slate-800; }
      .btn-secondary { @apply bg-white text-slate-900 border-slate-200 hover:bg-slate-50; }

      .nav-item { @apply flex items-center gap-2 rounded-xl px-3 py-2 text-sm text-slate-700 hover:bg-slate-100; }
      .nav-item.active { @apply bg-slate-900 text-white; }
      .nav-dot { @apply h-2 w-2 rounded-full bg-slate-300; }
      .nav-item.active .nav-dot { @apply bg-white; }

      .kv { @apply grid grid-cols-12 gap-3 items-start; }
      .kv > div:first-child { @apply col-span-4 text-sm text-slate-500; }
      .kv > div:last-child { @apply col-span-8 text-sm text-slate-900; }

      .rule-card { @apply rounded-2xl border border-slate-200 bg-white; }
      .rule-h { @apply px-5 pt-4 pb-3 border-b border-slate-100 flex items-start justify-between gap-4; }
      .rule-b { @apply p-5 space-y-4; }

      .callout { @apply rounded-2xl border border-slate-200 bg-slate-50 p-4 text-sm text-slate-700 leading-relaxed; }
      .table th { @apply text-xs font-semibold text-slate-600 bg-slate-50; }
      .table td, .table th { @apply px-3 py-3; }
      .table tr { @apply border-t border-slate-200; }
    </style>

    <script>
      function showSection(id) {
        const sections = document.querySelectorAll("[data-section]");
        sections.forEach(s => s.classList.add("hidden"));
        const target = document.getElementById(id);
        if (target) target.classList.remove("hidden");

        const items = document.querySelectorAll("[data-nav]");
        items.forEach(i => i.classList.remove("active"));
        const active = document.querySelector(`[data-nav='${id}']`);
        if (active) active.classList.add("active");

        history.replaceState(null, "", `#${id}`);
      }

      function boot() {
        const hash = (location.hash || "").replace("#", "");
        const defaultId = "overview";
        showSection(hash || defaultId);
      }

      window.addEventListener("DOMContentLoaded", boot);
    </script>
  </head>

  <body class="bg-slate-50 text-slate-900">
    <div class="min-h-screen flex">
      <!-- Sidebar -->
      <aside class="w-[320px] shrink-0 border-r border-slate-200 bg-white">
        <div class="p-5 border-b border-slate-200">
          <div class="flex items-center gap-3">
            <div class="h-10 w-10 rounded-2xl bg-slate-900 flex items-center justify-center text-white font-semibold">TH8</div>
            <div>
              <p class="text-sm font-semibold">Procurement Policy</p>
              <p class="text-xs text-slate-500">Business Rule Explanation</p>
            </div>
          </div>

          <div class="mt-4 flex flex-wrap gap-2">
            <span class="pill pill-slate">policy_id <span class="mono">PROCUREMENT-001</span></span>
            <span class="pill pill-slate">version <span class="mono">v3</span></span>
            <span class="pill pill-slate">effective <span class="mono">2024-01-01</span></span>
          </div>
        </div>

        <nav class="p-4 space-y-1">
          <button class="nav-item w-full active" data-nav="overview" onclick="showSection('overview')">
            <span class="nav-dot"></span> ภาพรวมเชิงธุรกิจ
          </button>
          <button class="nav-item w-full" data-nav="scope" onclick="showSection('scope')">
            <span class="nav-dot"></span> ขอบเขตและตัวชี้วัด
          </button>
          <button class="nav-item w-full" data-nav="thresholds" onclick="showSection('thresholds')">
            <span class="nav-dot"></span> เกณฑ์ (Thresholds)
          </button>
          <button class="nav-item w-full" data-nav="authority" onclick="showSection('authority')">
            <span class="nav-dot"></span> อำนาจอนุมัติ (Authority)
          </button>
          <button class="nav-item w-full" data-nav="rules" onclick="showSection('rules')">
            <span class="nav-dot"></span> กฎ (Rules) แบบละเอียด
          </button>
          <button class="nav-item w-full" data-nav="audit" onclick="showSection('audit')">
            <span class="nav-dot"></span> Audit & Governance
          </button>
        </nav>

        <div class="p-4 border-t border-slate-200">
          <div class="callout">
            <p class="font-semibold">หลักการขาย/อธิบายผู้บริหาร</p>
            <p class="mt-2">
              Policy นี้ “ไม่ใช่เอกสารเฉย ๆ” แต่เป็นมาตรฐานการตัดสินใจที่ทำให้:
              (1) งานเร็วขึ้นเพราะมีเกณฑ์ชัด (2) ลดความเสี่ยงเพราะ escalation ถูกบังคับใช้
              และ (3) ตรวจสอบย้อนหลังได้เพราะทุก step ผูกกับ audit event.
            </p>
          </div>
        </div>
      </aside>

      <!-- Main -->
      <main class="flex-1">
        <header class="sticky top-0 z-10 bg-slate-50/80 backdrop-blur border-b border-slate-200">
          <div class="px-6 py-4 flex items-center justify-between">
            <div>
              <p class="text-xs text-slate-500">TH8.AI Policy Library</p>
              <h1 class="text-lg font-semibold">Procurement Approval Control (v3)</h1>
            </div>
            <div class="flex items-center gap-2">
              <a class="btn btn-secondary" href="javascript:void(0)" onclick="showSection('rules')">ไปหน้ากฎ</a>
              <a class="btn btn-primary" href="javascript:void(0)" onclick="showSection('authority')">ดู authority</a>
            </div>
          </div>
        </header>

        <div class="p-6 max-w-6xl space-y-6">
          <!-- Overview -->
          <section id="overview" data-section class="space-y-6">
            <div class="card">
              <div class="card-h">
                <p class="text-base font-semibold">ภาพรวมเชิงธุรกิจ</p>
                <p class="text-sm text-slate-600 mt-1">
                  เป้าหมายของ Policy คือทำให้ “การอนุมัติจัดซื้อ” มีมาตรฐานเดียวกัน และบังคับใช้การยกระดับ (escalation) ตามความเสี่ยง
                </p>
              </div>
              <div class="card-b space-y-4">
                <div class="kv">
                  <div>ปัญหาที่แก้</div>
                  <div>
                    เคสยอดเงินสูง หรือใกล้ SLA มักต้องพึ่งคนเก่ง/ผู้จัดการ → ช้า เสี่ยงพลาด และอธิบายย้อนหลังยาก
                  </div>
                </div>
                <div class="kv">
                  <div>สิ่งที่ policy บังคับ</div>
                  <div>
                    ระบุเกณฑ์ “ต้อง escalate” และ “ต้องเตือน SLA” ให้ชัด และระบุ role ที่ต้องรับผิดชอบ
                  </div>
                </div>
                <div class="kv">
                  <div>สิ่งที่ผู้บริหารได้</div>
                  <div>
                    ลดเคสหลุดมาตรฐาน, ลดความเสี่ยงการอนุมัติผิดขั้น, และทำให้ตรวจสอบย้อนหลังได้แบบ event-by-event
                  </div>
                </div>

                <div class="callout">
                  <p class="font-semibold">การตีความผลลัพธ์</p>
                  <ul class="list-disc pl-5 mt-2 space-y-1">
                    <li><span class="mono">ESCALATE</span>: เคสต้องส่งขึ้นผู้มีอำนาจตาม role เพื่อความรับผิดชอบ</li>
                    <li><span class="mono">WARN</span>: เคสยังไม่ถึงขั้น escalate แต่ต้องเตือนทีมปฏิบัติการให้เร่งดำเนินการ</li>
                  </ul>
                </div>
              </div>
            </div>
          </section>

          <!-- Scope -->
          <section id="scope" data-section class="hidden space-y-6">
            <div class="card">
              <div class="card-h">
                <p class="text-base font-semibold">ขอบเขตและตัวชี้วัด</p>
                <p class="text-sm text-slate-600 mt-1">Policy นี้ใช้กับงาน Procurement และการตัดสินใจประเภท APPROVAL</p>
              </div>
              <div class="card-b space-y-4">
                <div class="kv">
                  <div>Decision Type</div>
                  <div class="mono">APPROVAL</div>
                </div>
                <div class="kv">
                  <div>Applies to</div>
                  <div>purchase_order, contract</div>
                </div>

                <div class="callout">
                  <p class="font-semibold">KPI ที่แนะนำให้ใช้คู่กัน</p>
                  <ul class="list-disc pl-5 mt-2 space-y-1">
                    <li>เวลาเฉลี่ยตั้งแต่ “เปิดเคส” → “มีข้อเสนอแนะ (recommendation)”</li>
                    <li>จำนวนเคสที่ถูก <span class="mono">ESCALATE</span> และใช้เวลาปิดเคสเท่าไร</li>
                    <li>จำนวนเคสที่โดน <span class="mono">WARN</span> ใกล้ SLA และมีการแก้ไขทันหรือไม่</li>
                    <li>สัดส่วนเคสที่มี evidence แนบครบก่อนอนุมัติ (เชิง compliance)</li>
                  </ul>
                </div>
              </div>
            </div>
          </section>

          <!-- Thresholds -->
          <section id="thresholds" data-section class="hidden space-y-6">
            <div class="card">
              <div class="card-h">
                <p class="text-base font-semibold">เกณฑ์ (Thresholds) ที่ policy ใช้</p>
                <p class="text-sm text-slate-600 mt-1">เกณฑ์เหล่านี้คือ “จุดตัดสินใจ” ที่ทำให้ระบบทำงานแบบสม่ำเสมอ</p>
              </div>
              <div class="card-b">
                <table class="w-full table text-sm overflow-hidden rounded-xl border border-slate-200">
                  <thead>
                    <tr>
                      <th class="text-left">ชื่อเกณฑ์</th>
                      <th class="text-left">ความหมายเชิงธุรกิจ</th>
                      <th class="text-right">ค่า</th>
                      <th class="text-left">ผลกระทบ</th>
                    </tr>
                  </thead>
                  <tbody class="bg-white">
                    <tr>
                      <td class="mono">high_amount_thb</td>
                      <td>ยอดรวมเคสที่ถือว่า “มูลค่าสูง” ต้องยกระดับการอนุมัติ</td>
                      <td class="text-right mono">3,000,000</td>
                      <td><span class="pill pill-rose">ESCALATE</span></td>
                    </tr>
                    <tr>
                      <td class="mono">sla_warning_hours</td>
                      <td>จำนวนชั่วโมงคงเหลือก่อน SLA ที่ต้องเริ่มเตือนทีม</td>
                      <td class="text-right mono">6</td>
                      <td><span class="pill pill-amber">WARN</span></td>
                    </tr>
                  </tbody>
                </table>

                <div class="callout mt-5">
                  <p class="font-semibold">เหตุผลที่ต้องมี thresholds</p>
                  <p class="mt-2">
                    ถ้าไม่มีเกณฑ์ชัด งานจะกลับไปเป็น “ดุลพินิจเฉพาะคน” ทำให้มาตรฐานไม่สม่ำเสมอ
                    และยากต่อการอธิบายผู้ตรวจ/ผู้บริหารว่า “ทำไมเคสนี้ถึงผ่าน/ไม่ผ่าน/ต้องส่งต่อ”
                  </p>
                </div>
              </div>
            </div>
          </section>

          <!-- Authority -->
          <section id="authority" data-section class="hidden space-y-6">
            <div class="card">
              <div class="card-h">
                <p class="text-base font-semibold">อำนาจอนุมัติ (Authority Matrix)</p>
                <p class="text-sm text-slate-600 mt-1">ระบุ role ที่ต้องรับผิดชอบเมื่อเข้าเงื่อนไขต่าง ๆ</p>
              </div>
              <div class="card-b space-y-4">
                <div class="callout">
                  <p class="font-semibold">แนวคิด</p>
                  <p class="mt-2">
                    Authority matrix คือ “กติกาองค์กร” ว่าเคสระดับไหนต้องให้ใครเป็นผู้อนุมัติ/รับผิดชอบ
                    เพื่อลดความเสี่ยงและป้องกันการอนุมัติผิดระดับ
                  </p>
                </div>

                <table class="w-full table text-sm overflow-hidden rounded-xl border border-slate-200">
                  <thead>
                    <tr>
                      <th class="text-left">เงื่อนไข</th>
                      <th class="text-left">ความหมาย</th>
                      <th class="text-left">required_role</th>
                    </tr>
                  </thead>
                  <tbody class="bg-white">
                    <tr>
                      <td class="mono">amount_total &gt; 3,000,000</td>
                      <td>มูลค่าสูง ต้องให้ผู้จัดการจัดซื้อรับผิดชอบ</td>
                      <td class="mono">Procurement_Manager</td>
                    </tr>
                    <tr>
                      <td class="mono">amount_total &lt;= 3,000,000</td>
                      <td>มูลค่าไม่ถึงเกณฑ์สูง ใช้เจ้าหน้าที่จัดซื้อรับผิดชอบตามกระบวนการ</td>
                      <td class="mono">Procurement_Officer</td>
                    </tr>
                  </tbody>
                </table>

                <div class="callout">
                  <p class="font-semibold">สิ่งที่ UI ควรแสดง</p>
                  <ul class="list-disc pl-5 mt-2 space-y-1">
                    <li>แสดง “required_role” ชัดเจนบนหน้าเคส เพื่อให้ทีมรู้ว่าใครต้องทำต่อ</li>
                    <li>แสดงเหตุผลเป็นภาษา business เช่น “ยอดสูงกว่า 3,000,000” ไม่ใช่แค่ชื่อ rule</li>
                    <li>ให้คลิก drill-down ไปดู rule + threshold ได้ทันที</li>
                  </ul>
                </div>
              </div>
            </div>
          </section>

          <!-- Rules -->
          <section id="rules" data-section class="hidden space-y-6">
            <div class="card">
              <div class="card-h">
                <p class="text-base font-semibold">กฎ (Rules) แบบละเอียด</p>
                <p class="text-sm text-slate-600 mt-1">อธิบาย “เมื่อไร” และ “แล้วต้องทำอะไร” ให้ผู้บริหาร/ออดิทอ่านเข้าใจ</p>
              </div>
              <div class="card-b space-y-5">
                <!-- Rule 1 -->
                <div class="rule-card">
                  <div class="rule-h">
                    <div>
                      <p class="text-sm font-semibold">HIGH_AMOUNT_ESCALATION</p>
                      <p class="text-xs text-slate-500 mt-1">High value procurement must be escalated</p>
                    </div>
                    <div class="flex flex-wrap gap-2 justify-end">
                      <span class="pill pill-rose">then: ESCALATE</span>
                      <span class="pill pill-slate">required_role: <span class="mono">Procurement_Manager</span></span>
                    </div>
                  </div>
                  <div class="rule-b">
                    <div class="kv">
                      <div>Business intent</div>
                      <div>
                        ป้องกันการอนุมัติรายการมูลค่าสูงโดยไม่มีผู้รับผิดชอบระดับผู้จัดการ
                        ลดความเสี่ยงด้านงบประมาณ, vendor risk, และ compliance
                      </div>
                    </div>

                    <div class="kv">
                      <div>When (เงื่อนไข)</div>
                      <div>
                        ถ้า <span class="mono">amount_total</span> มากกว่า <span class="mono">3,000,000 THB</span>
                      </div>
                    </div>

                    <div class="kv">
                      <div>Then (ผลลัพธ์)</div>
                      <div>
                        ระบบต้องทำสถานะ “ส่งต่อเพื่ออนุมัติ” (<span class="mono">ESCALATE</span>) และกำหนดผู้รับผิดชอบเป็น <span class="mono">Procurement_Manager</span>
                      </div>
                    </div>

                    <div class="callout">
                      <p class="font-semibold">ตัวอย่างที่เข้าเงื่อนไข</p>
                      <ul class="list-disc pl-5 mt-2 space-y-1">
                        <li>เคสยอดรวม 3.2M → ต้องส่งให้ Procurement Manager ก่อนอนุมัติ</li>
                        <li>เคสยอดรวม 2.9M → ไม่เข้าเงื่อนไขนี้ (ยังอาจเข้า rule อื่น เช่น SLA)</li>
                      </ul>
                    </div>

                    <div class="callout">
                      <p class="font-semibold">สิ่งที่ต้องแสดงบน UI (เพื่อ “ขายได้”)</p>
                      <ul class="list-disc pl-5 mt-2 space-y-1">
                        <li>โชว์ threshold ที่ใช้ตัดสินใจ (3,000,000) และค่าจริงของเคส</li>
                        <li>โชว์ required_role + next action (ส่งต่อ/ขออนุมัติ)</li>
                        <li>ลิงก์ไป evidence ที่เกี่ยวข้อง (เช่น clause ใน policy เอกสาร)</li>
                      </ul>
                    </div>
                  </div>
                </div>

                <!-- Rule 2 -->
                <div class="rule-card">
                  <div class="rule-h">
                    <div>
                      <p class="text-sm font-semibold">SLA_RISK</p>
                      <p class="text-xs text-slate-500 mt-1">Procurement close to SLA deadline</p>
                    </div>
                    <div class="flex flex-wrap gap-2 justify-end">
                      <span class="pill pill-amber">then: WARN</span>
                      <span class="pill pill-slate">required_role: <span class="mono">Procurement_Officer</span></span>
                    </div>
                  </div>
                  <div class="rule-b">
                    <div class="kv">
                      <div>Business intent</div>
                      <div>
                        ลดเคสหลุด SLA โดยเตือนล่วงหน้าให้ทีมเร่งปิดงาน (ลด penalty / ลด escalation ที่ไม่จำเป็น)
                      </div>
                    </div>

                    <div class="kv">
                      <div>When (เงื่อนไข)</div>
                      <div>
                        ถ้า <span class="mono">sla_hours_remaining</span> น้อยกว่าหรือเท่ากับ <span class="mono">6 ชั่วโมง</span>
                      </div>
                    </div>

                    <div class="kv">
                      <div>Then (ผลลัพธ์)</div>
                      <div>
                        ระบบทำสัญญาณเตือน (<span class="mono">WARN</span>) ให้ <span class="mono">Procurement_Officer</span> เร่งดำเนินการ / แจ้งเตือนผู้เกี่ยวข้อง
                      </div>
                    </div>

                    <div class="callout">
                      <p class="font-semibold">ตัวอย่างผลลัพธ์ที่คาดหวัง</p>
                      <ul class="list-disc pl-5 mt-2 space-y-1">
                        <li>เหลือ 4 ชั่วโมงก่อน SLA → ขึ้น Warning และส่ง alert ให้ทีม</li>
                        <li>เหลือ 10 ชั่วโมง → ยังไม่เตือน (แต่ยังติดตามได้ใน monitoring)</li>
                      </ul>
                    </div>

                    <div class="callout">
                      <p class="font-semibold">สิ่งที่ UI ควรมี (เพื่อความเป็นมืออาชีพ)</p>
                      <ul class="list-disc pl-5 mt-2 space-y-1">
                        <li>แสดง countdown SLA และระดับความเร่งด่วน</li>
                        <li>มีปุ่ม “notify owner / escalate” (ในระบบจริง) และทุก action ต้องเขียน audit event</li>
                        <li>ใน monitoring ควร aggregate เคสที่เข้าเงื่อนไขนี้เพื่อให้หัวหน้าดูภาพรวม</li>
                      </ul>
                    </div>
                  </div>
                </div>

                <div class="callout">
                  <p class="font-semibold">หมายเหตุเรื่องการตรวจสอบย้อนหลัง</p>
                  <p class="mt-2">
                    ในระบบที่ “ขายองค์กรได้” ควรบันทึก <span class="mono">RULE_EVALUATED</span> เป็นราย rule
                    เพื่อให้ยืนยันได้ว่า rule ถูกตรวจจริง (ไม่ใช่เลือกเฉพาะ rule ที่อยากโชว์)
                  </p>
                </div>
              </div>
            </div>
          </section>

          <!-- Audit -->
          <section id="audit" data-section class="hidden space-y-6">
            <div class="card">
              <div class="card-h">
                <p class="text-base font-semibold">Audit & Governance</p>
                <p class="text-sm text-slate-600 mt-1">ตั้งค่าให้เหมาะกับองค์กร: FULL logging และเก็บ 7 ปี</p>
              </div>
              <div class="card-b space-y-4">
                <div class="kv">
                  <div>log_level</div>
                  <div class="mono">FULL</div>
                </div>
                <div class="kv">
                  <div>retain_years</div>
                  <div class="mono">7</div>
                </div>

                <div class="callout">
                  <p class="font-semibold">แปลความหมายแบบผู้บริหาร</p>
                  <ul class="list-disc pl-5 mt-2 space-y-1">
                    <li><span class="mono">FULL</span>: เก็บทั้งการประเมิน rule, recommendation, evidence, และการตัดสินใจของคน</li>
                    <li><span class="mono">7 years</span>: รองรับการตรวจย้อนหลังตามแนวปฏิบัติองค์กร/กฎหมาย/สัญญา</li>
                  </ul>
                </div>

                <div class="callout">
                  <p class="font-semibold">Checklist ที่ควรถามก่อน go-live</p>
                  <ul class="list-disc pl-5 mt-2 space-y-1">
                    <li>ใครคือ owner ของ policy และกระบวนการเปลี่ยน version คืออะไร</li>
                    <li>เวลา policy เปลี่ยน ต้อง trace ได้ไหมว่าเคสไหนใช้เวอร์ชันไหน</li>
                    <li>หลักฐาน (evidence) เก็บในที่ไหน และเปิดดูได้จริง (ไม่ใช่แค่ข้อความ)</li>
                    <li>สิทธิ์การเข้าถึง audit trail (role-based) และการ export สำหรับ auditor</li>
                  </ul>
                </div>
              </div>
            </div>

            <footer class="py-6 text-xs text-slate-500">
              TH8.AI • Procurement Policy v3 • Business Explanation • Font: Prompt
            </footer>
          </section>
        </div>
      </main>
    </div>
  </body>
</html>
